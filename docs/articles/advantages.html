<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The advantages of tic • tic</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The advantages of tic">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tic</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.13.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advantages.html">Why you should use tic</a>
    </li>
    <li>
      <a href="../articles/build-lifecycle.html">The CI build lifecycle</a>
    </li>
    <li>
      <a href="../articles/tic-usethis-travis.html">tic, travis and usethis</a>
    </li>
    <li>
      <a href="../articles/advanced.html">Advanced usage</a>
    </li>
    <li>
      <a href="../articles/deployment.html">Everything related to deployment</a>
    </li>
    <li>
      <a href="../articles/custom-steps.html">Developer - custom steps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropenscilabs/tic">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The advantages of tic</h1>
                        <h4 class="author">Patrick Schratz, Kirill Müller</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropenscilabs/tic/blob/master/vignettes/advantages.Rmd"><code>vignettes/advantages.Rmd</code></a></small>
      <div class="hidden name"><code>advantages.Rmd</code></div>

    </div>

    
    
<p>So, what’s the advantage of using <code>tic</code> over the standard CI process?</p>
<ul>
<li>CI-agnostic workflow definitions (in R!)</li>
<li>Simplified deployment (e.g. <code>pkgdown</code> site)</li>
<li>Improved package checking via <a href="https://github.com/r-lib/rcmdcheck">rcmdcheck</a>
</li>
<li>Robust caching approach</li>
</ul>
<div id="ci-agnostic-workflows" class="section level2">
<h2 class="hasAnchor">
<a href="#ci-agnostic-workflows" class="anchor"></a>CI-Agnostic workflows</h2>
<p>What does “CI-Agnostic” mean and why do we need it?</p>
<p>You may have heard that multiple CI services exist in the wild. Some only support specific operating systems or certain languages and for some you need to pay a monthly rate to use them. What all have in common: They have their own way to specify their setup file, which is most often written in YAML and stored at the top-level directory of your repo. This setup file controls what will be done in each run.</p>
<p>To give you an example how different these control files can be, take a look at these two examples from <a href="https://github.com/tidyverse/dplyr/blob/master/.travis.yml">Travis</a> and <a href="https://github.com/tidyverse/dplyr/blob/master/appveyor.yml">Appveyor</a>. While Travis is the only free CI service with an “official” support for R (maintained by the community, specifically by <span class="citation">@jimhester</span>), <code>Appveyor</code> currently requires quite some magic (e.g. <code>travis-tool.sh</code>) in the background to install a working R framework.</p>
<p>We could list way more differences - but that’s exactly the point when <code>tic</code> comes in!</p>
<ul>
<li>Rather than dealing with all the CI differences, <code>tic</code> enables the specification of the complete workflow in an external R script file <code>tic.R</code>.</li>
<li>The commands specified in there will be understood on every CI service that is supported by <code>tic</code>.</li>
<li>Furthermore, you can <a href="advantages.html#less-dependency-on-external-ci-control-commands">emulate all the stages and steps locally</a> by calling <code><a href="../reference/tic.html">tic()</a></code>.</li>
<li>You are independent from all the changes that are being made on the R setup for Travis or Appveyor (<a href="(advantages.html#less-dependency-on-external-ci-control-commands)">more info</a>.</li>
<li>A <code>tic.R</code> workflow is usually shorter and easier to parse than a <code>.travis.yml</code> or <code>appveyor.yml</code> file.</li>
</ul>
<p>So instead of learning how to specify specific tasks on different CI platforms, you only need to learn how to do with R commands.</p>
</div>
<div id="easier-deployment" class="section level2">
<h2 class="hasAnchor">
<a href="#easier-deployment" class="anchor"></a>Easier deployment</h2>
<p>You may know that CI services can be used to automatically deploy files. This means that these services can push certain files created during the build to repositories (Github, Gitlab, etc.). A common use case is to build your <code>pkgdown</code> site and conditionally push changes to your repo. This practice saves you from building the whole <code>pkgdown</code> site locally and then committing manually all the changed files - either Travis or Appveyor will do it for you! <code>tic</code> takes care of all the setup work (setting up SSH keys, permission granting for the repo on Github and the CI services). In combination with <code>usethis::use_ci()</code> this whole preparation process is streamlined and needs only be called once for every repo by the user.</p>
<p>For more information on automatic deployment in <code>tic</code>, take a look <a href="deployment.html">here</a>.</p>
</div>
<div id="enhanced-r-package-checking-rcmdcheck-r-cmd-check" class="section level2">
<h2 class="hasAnchor">
<a href="#enhanced-r-package-checking-rcmdcheck-r-cmd-check" class="anchor"></a>Enhanced R package checking: <code>rcmdcheck()</code> &gt; R CMD check</h2>
<p>As a R package developer you are most likely used to call <code><a href="http://www.rdocumentation.org/packages/devtools/topics/check">devtools::check()</a></code> or directly <code>R CMD check</code> on your built package. Usually also Travis will run <code>R CMD check</code> to check the R package. <code>tic</code> instead uses <a href="https://github.com/r-lib/rcmdcheck"><code>rcmdcheck</code></a>, which can be seen as a wrapper around <code>R CMD build</code> and <code>R CMD check</code>. It was developed by <a href="https://github.com/gaborcsardi">Gabor Csardi</a>. <code>rcmdcheck</code> comes with several enhancements:</p>
<ul>
<li>Coloring of important steps, simplifying the readability of the log</li>
<li>Enhanced and extended tracebacks of errors, especially errors in tests</li>
<li>The whole check process is returned in a R object, making it easier to inspect eventual errros/warnings</li>
</ul>
<p>Especially the extended log printing of errors on the CI service is a huge advantage - often enough, CI services cut log output ot the console early, omitting important information about the error.</p>
<p>Here is an short excerpt of the improved log output by <code>rcmdcheck</code> including an error message:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"></code></pre></div>
</div>
<div id="caching-of-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#caching-of-packages" class="anchor"></a>Caching of packages</h2>
<p>When using <code>tic</code> all dependencies (the ones of the package and of also the ones of all stages of the CI build) are installed in the “before_install” stage. This has the advantage that all packages get added to the cache (even if they are just needed for deployment), speeding up subsequent builds substantially. <code>tic</code> uses two distinct R libraries for caching: One for the dependencies that are used for checking the R package and another R package library for all other dependencies (e.g. for packages that are used during the “deploy” stage). The reason for that is that sometimes dependencies for specific stages (e.g. “the deploy” stage) may cause errors when checking the R package because these contain breaking changes which the package is not able to deal with (e.g. if the Github version of a package is installed). You do not need to worry about this in practice - both will be cached and handled in the background for you!</p>
<p>More information about the whole CI workflow can be found in the <a href="build-lifecycle.html">Build lifecyle</a> vignette.</p>
</div>
<div id="easier-troubleshooting" class="section level2">
<h2 class="hasAnchor">
<a href="#easier-troubleshooting" class="anchor"></a>Easier troubleshooting</h2>
<p><code>tic</code> comes with the ability to emulate the CI run locally and debug potential problems. This is possible because <code>tic.R</code> is a plain R file that will be sourced when calling <code><a href="../reference/tic.html">tic()</a></code>. It will run all the stages and steps in the same order as it would happen on the CI service.</p>
<p>Sometimes CI builds error (even multiple times) and you don’t know whether the error is caused by the CI service or by a wrong workflow specification on your side.</p>
<p>To make sure that you have no syntax errors in your <code>tic.R</code> file, all you need to do is to call <code><a href="../reference/load_from_file.html">load_from_file()</a></code>. In case you have errors, you will see them directly. For example, removing a closing bracket on purpose in <code>tic.R</code> would return the following when calling <code><a href="../reference/load_from_file.html">load_from_file()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/load_from_file.html">load_from_file</a></span>()</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">Error <span class="cf">in</span> <span class="kw">source</span>(path, <span class="dt">local =</span> dsl) <span class="op">:</span><span class="st"> </span>tic.R<span class="op">:</span><span class="dv">16</span><span class="op">:</span><span class="dv">1</span><span class="op">:</span><span class="st"> </span>unexpected <span class="st">'}'</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="dv">15</span><span class="op">:</span><span class="st">     </span><span class="kw"><a href="../reference/DSL.html">add_step</a></span>(<span class="kw"><a href="../reference/step_push_deploy.html">step_push_deploy</a></span>())</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="dv">16</span><span class="op">:</span><span class="st"> </span><span class="er">}</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="op">^</span></a></code></pre></div>
<p>See <a href="advanced#troubleshooting-running-tic-locally">Troubleshooting: Running tic locally</a> and <a href="advanced#troubleshooting-entering-the-cI-build">Troubleshooting: Entering the CI build</a> for instructions on how to debug your CI build in more detail.</p>
</div>
<div id="less-dependency-on-external-ci-control-commands" class="section level2">
<h2 class="hasAnchor">
<a href="#less-dependency-on-external-ci-control-commands" class="anchor"></a>Less dependency on external CI control commands</h2>
<p>Most CI services come with no (native) support for the R programming language. For Travis and Appveyor, the support is provided by the R community. For example, <a href="https://github.com/travis-ci/travis-build/blob/master/lib/travis/build/script/r.rb">r.rb</a> controls what happens if you set <code>language: r</code> on Travis. All of the commands and arguments specified there can also be set in <code>tic.R</code> using R syntax. So you are no longer dependent on the syntax and restrictions coming from <a href="https://github.com/travis-ci/travis-build/blob/master/lib/travis/build/script/r.rb">r.rb</a> but able to control the whole CI workflow in a single R file.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#ci-agnostic-workflows">CI-Agnostic workflows</a></li>
      <li><a href="#easier-deployment">Easier deployment</a></li>
      <li><a href="#enhanced-r-package-checking-rcmdcheck-r-cmd-check">Enhanced R package checking: <code>rcmdcheck()</code> &gt; R CMD check</a></li>
      <li><a href="#caching-of-packages">Caching of packages</a></li>
      <li><a href="#easier-troubleshooting">Easier troubleshooting</a></li>
      <li><a href="#less-dependency-on-external-ci-control-commands">Less dependency on external CI control commands</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kirill Müller, Mika Braginsky, Karthik Ram, Jeroen Ooms, Patrick Schratz, rOpenSci.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
